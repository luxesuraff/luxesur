---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { cities } from "../../data/cities";
import { INTENT_CONFIG } from "../../config/intents";
import Hero from "../../components/Hero.astro";

export async function getStaticPaths() {
  return cities.map((city) => ({
    params: { city: city.slug },
    props: { city },
  }));
}

const { city } = Astro.props;
const cityName = city.city;
const state = city.state;

// ðŸ”’ LOCKED INTENT KEY
const intent = "emergency-plumbing";
const intentConfig = INTENT_CONFIG[intent];

const pageTitle = `Emergency Plumbing in ${cityName}, ${state} | Local Help Available`;
const metaDescription = `Need emergency plumbing in ${cityName}, ${state}? Get help for urgent plumbing issues like leaks, backups, and sudden water loss.`;
---
<BaseLayout title={pageTitle} description={metaDescription}>

<!-- HERO (ALWAYS RENDER, CTA GATED) -->
<Hero
  src="/images/emergency-plumbing/emergency/hero.webp"
  alt={`Emergency plumbing help in ${cityName}, ${state}`}
  phone={intentConfig?.ctaEnabled ? intentConfig.phone : null}
/>

<!-- HERO TEXT -->
<section class="hero">
  <h1>Emergency Plumbing in {cityName}, {state}</h1>

  <p>
    Plumbing emergencies can cause serious damage if not addressed quickly.
    Issues such as burst pipes, sewer backups, or sudden water loss require
    immediate attention.
  </p>

  <p>
    If you are dealing with an urgent plumbing problem in {cityName}, {state},
    help may be available through independent local plumbing professionals.
  </p>
</section>

<section>
  <h2>What Is Considered a Plumbing Emergency?</h2>
  <ul>
    <li>Burst or leaking pipes</li>
    <li>Sewer backups or overflowing drains</li>
    <li>No running water or sudden pressure loss</li>
    <li>Water heater failures</li>
  </ul>
</section>

<section>
  <h2>Why Fast Emergency Plumbing Response Matters</h2>
  <p>
    Addressing emergency plumbing problems promptly can help limit damage,
    reduce repair costs, and restore normal use of your plumbing system.
  </p>
</section>

<section class="final-cta">
  <h2>Need Emergency Plumbing Help in {cityName}?</h2>

  {intentConfig?.ctaEnabled && (
    <a href={intentConfig.phone} class="cta-button">
      Call Now for Emergency Plumbing Assistance
    </a>
  )}
</section>

</BaseLayout>
